name: "04-02 Deploy Hotfix to Prod"
run-name: "deploy hotfix-${{ github.event.workflow_run.run_number }} to prod"

on:
  workflow_dispatch:
    inputs:
      version_tag:
        description: 'Version tag'
        required: true
        type: string

jobs:
  deploy:
    runs-on: ubuntu-latest

    environment:
      name: 'prod'

    steps:
      - name: Show the version tag
        run: echo ${{ inputs.version_tag  }}

      - name: Deploy application
        uses: fjogeleit/http-request-action@v1
        with:
          url: 'https://r-systems-cloud.com/api/hooks/git-tests-prod'
          method: 'POST'
          customHeaders: '{"x-api-key": "${{ secrets.DEPLOY_PROD_APP_KEY }}"}'
          data: '{"image_tag": "${{ inputs.version_tag }}"}'
          timeout: 300000